map $subdominio $micrositio_ceu {

  admininmobilien           1;
  ancoven                   1;
  arkinatura                1;
  arquitectonica            1;
  bienesiruven              1;
  buenaventuravistad        1;
  camposycampos             1;
  casacaribe                1;
  casagroup                 1;
  casareal                  1;
  coldwellbanker            1;
  complejocostalinda        1;
  conefic                   1;
  consorcioinmplaza         1;
  consorciopaldaca          1;
  constructora8888          1;
  constructoragonpacon      1;
  construcwestfargot        1;
  costructorapqehabita      1;
  csingenieros              1;
  desarrollocaicataima      1;
  desarrollopartres         1;
  desarrolloscaicataima     1;
  desarrollospr2            1;
  desarrollosprosinco       1;
  fercarentals              1;
  gpomorro88                1;
  grupoeiffel               1;
  grupoindamal              1;
  gruponorma                1;
  gruporiviera              1;
  grupovinsoca              1;
  hdinversiones             1;
  hlservices                1;
  ingenierosvya             1;
  inversiones210696         1;
  inversiontoscany          1;
  logicainmobiliaria        1;
  losaltos                  1;
  losinnovadores            1;
  posadacanalazul           1;
  premierconstruccion       1;
  promotora2mz              1;
  promotorainmobiliari      1;
  promotoralaspalmeras      1;
  promotorapaepar           1;
  promotoraxx41             1;
  promotverdecana           1;
  remaxharrisbreto          1;
  serviciosingecon2021      1;
  servinmuebles             1;
  stambul                   1;
  superobras                1;
  variedadesinmobilia       1;
  villasalva1               1;
  villasalva2               1;

}

map $subdominio $micrositio_empleos {

  abb                                 1;
  adecco                              1;
  ameriven                            1;
  arturos                             1;
  asap                                1;
  atento                              1;
  avon                                1;
  bahias                              1;
  bancoexterior                       1;
  bancoro                             1;
  banplus                             1;
  bayer                               1;
  bdm                                 1;
  beco                                1;
  behrens                             1;
  bod                                 1;
  caf                                 1;
  cativen                             1;
  celulasmadre                        1;
  centralmadeirense                   1;
  century21grupobr                    1;
  coldwell                            1;
  congente                            1;
  consorcioisven                      1;
  cosapi                              1;
  ditech                              1;
  eiffel                              1;
  eluniversal                         1;
  empleos2                            1;
  empleosf                            1;
  empresas-yv                         1;
  epa                                 1;
  epower                              1;
  epran                               1;
  ericsson                            1;
  estratego                           1;
  expotalento                         1;
  fcg                                 1;
  ferretotal                          1;
  fonden                              1;
  galea                               1;
  globalcare                          1;
  gpdh                                1;
  hermocordialsa                      1;
  humanitas                           1;
  inelectra                           1;
  inter                               1;
  iscbunker                           1;
  jmcyr                               1;
  lenovo                              1;
  lucy                                1;
  micasa                              1;
  microsite                           1;
  montana                             1;
  netuno                              1;
  plumrose                            1;
  prc333                              1;
  prosein                             1;
  qualitas                            1;
  rescarven                           1;
  royalsunalliance                    1;
  sanitas                             1;
  segurosaltamira                     1;
  seguroscaracas                      1;
  segurosqualitas                     1;
  sincor                              1;
  supercable                          1;
  tecnoconsult                        1;
  torondoy                            1;
  ueseg                               1;
  usb                                 1;
  venezolanadepinturas                1;
  venezolano                          1;
  venuscol                            1;
  vepica                              1;
  vocem                               1;
  yanbal                              1;
  yogenfruz                           1;
  yvsitio                             1;

}

# SUBDOMINIOS ELUNIVERSAL

map $subdominio $subdominios_eluniversal {

  alemania2006        http://www.eluniversal.com/;
  apps                http://www.eluniversal.com/;
  aquista             http://www.eluniversal.com/;
  archivo             http://www.eluniversal.com/;
  bb                  http://m.eluniversal.com;
  beisbol             http://www.eluniversal.com/deportes/beisbol/;
  blogs               http://www.eluniversal.com/blogs/;
  buscador            http://www.eluniversal.com/resultado;
  calidaddevida       http://www.eluniversal.com/vida/;
  caracas             http://www.eluniversal.com/caracas/;
  carros              http://clasificadoseluniversal.com/Carros;
  cine                http://www.eluniversal.com/arte-y-entretenimiento/cine/;
  cines               http://www.eluniversal.com/;
  ciudad              http://www.eluniversal.com/;
  coleccionables      http://www.eluniversal.com/;
  deportes            http://www.eluniversal.com/deportes/;
  doblevia            http://www.eluniversal.com/doblevia/;
  economia            http://www.eluniversal.com/economia/;
  english             http://www.eluniversal.com/english/;
  espectaculos        http://www.eluniversal.com/arte-y-entretenimiento/;
  estampas            http://www.estampas.com/;
  fam                 http://www.eluniversal.com/;
  fotos               http://clasificadoseluniversal.com/;
  guarenasguatire     http://www.eluniversal.com/;
  guiaturistica       http://www.eluniversal.com/guia-turistica/;
  inmuebles           http://clasificadoseluniversal.com/Inmuebles;
  internacional       http://www.eluniversal.com/internacional/;
  iphone              http://m.eluniversal.com;
  mascotas            http://www.eluniversal.com/;
  noticias            http://www.eluniversal.com;
  opinion             http://www.eluniversal.com/opinion/;
  pagos               http://www.clasificadoseluniversal.com/;
  playball            http://www.eluniversal.com/deportes/beisbol/;
  politica            http://www.eluniversal.com/nacional-y-politica/;
  publicidad          http://www.eluniversal.com/;
  quehay              http://www.eluniversal.com/;
  quintocuerpo        http://www.eluniversal.com/;
  rayma               http://www.eluniversal.com/;
  registro            http://www.eluniversal.com/registro/do/showHome;
  sociales            http://www.eluniversal.com/sociales/;
  sudoku              http://www.eluniversal.com/arte-y-entretenimiento/sudoku/;
  suscripciones       http://www.eluniversal.com/static/eu4/suscripciones/;
  tiempolibre         http://www.eluniversal.com/;
  trivia              http://www.eluniversal.com/;
  turismo             http://www.eluniversal.com/guia-turistica/;
  universo            http://www.eluniversal.com/universo-empresarial/;
  zona                http://www.eluniversal.com/;
}


server {
  listen {{ service_ip }}:80;
  listen {{ service_ip }}:7777;
  server_name ~^(?P<subdominio>.+)\.eluniversal\.com$;   

  access_log logs/subdominios-access.log;


  proxy_set_header Host $host;
  proxy_set_header X-Real-IP $remote_addr;
  proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
  proxy_redirect off;
  proxy_ignore_headers expires Cache-Control Set-Cookie;
  proxy_cache_valid 200 404 1m;
  proxy_cache_use_stale updating error timeout invalid_header http_500 http_502 http_503 http_504 http_404;
  proxy_cache_key "$http_host$request_uri";
  proxy_buffering on;
  proxy_buffer_size 4k;
  proxy_buffers 8 32k;
  #proxy_hide_header Set-Cookie;
  proxy_pass_header Set-Cookie;
  proxy_cache docs;
  proxy_http_version 1.1;
  proxy_set_header Accept-Encoding "";

  location / {

    if ($micrositio_ceu) {
      return 302 http://clasificadoseluniversal.com/micrositio/$subdominio/$is_args$args; 
    }

    if ($micrositio_empleos) {
      proxy_pass http://empleos_backend$uri$is_args$args;
    }  

    if ($subdominios_eluniversal) {
      return 301 $subdominios_eluniversal$is_args$args;
    }

    error_page 403 404 500 502 503 504 =200 http://www.eluniversal.com$is_args$args; 
  }

}

server {
  listen {{ service_ip }}:80;
  listen {{ service_ip }}:7777;
  server_name ~^(?P<subdominio>.+)\.cvfuturo\.com$;   

  access_log logs/cvfuturo-subdominios-access.log;

  return 301 http://$subdominio.eluniversal.com$request_uri;

}
